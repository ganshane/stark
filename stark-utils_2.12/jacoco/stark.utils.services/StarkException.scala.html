<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>StarkException.scala</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Stark Utils Support</a> &gt; <a href="index.source.html" class="el_package">stark.utils.services</a> &gt; <span class="el_source">StarkException.scala</span></div><h1>StarkException.scala</h1><pre class="source lang-java linenums">// Copyright 2014,2015,2016 the original author or authors. All rights reserved.
// site: http://www.ganshane.com
package stark.utils.services

import java.io.{PrintStream, PrintWriter}


/**
 * Monad整个系统异常消息
 * 异常消息编号有:
 * monad-support             1000
 * monad-jni                 4000
 *
 * @author jcai
 */
<span class="nc" id="L16">object StarkException {</span>
<span class="nc" id="L17">  def wrap(exception: Throwable): StarkException = wrap(exception, null)</span>

  def wrap(exception: Throwable, errorCode: ErrorCode): StarkException = {
<span class="nc" id="L20">    wrap(exception, errorCode, exception.getMessage)</span>
  }

  def wrap(exception: Throwable, errorCode: ErrorCode, message: String): StarkException = {
<span class="nc" id="L24">    exception match {</span>
<span class="nc bnc" id="L25" title="All 2 branches missed.">      case me: StarkException =&gt;</span>
<span class="nc bnc" id="L26" title="All 8 branches missed.">        if (errorCode != null &amp;&amp; errorCode != me.errorCode) {</span>
<span class="nc" id="L27">          return new StarkException(message, exception, errorCode)</span>
        }
<span class="nc" id="L29">        me</span>
      case _ =&gt;
<span class="nc" id="L31">        new StarkException(message, exception, errorCode)</span>
    }
  }
}

<span class="nc" id="L36">class StarkException(message: String, cause: Throwable, val errorCode: ErrorCode) extends RuntimeException(message, cause) {</span>
<span class="nc" id="L37">  def this(errorCode: ErrorCode) = this(null, null, errorCode)</span>

<span class="nc" id="L39">  def this(message: String, errorCode: ErrorCode) = this(message, null, errorCode)</span>

<span class="nc" id="L41">  def this(cause: Throwable, errorCode: ErrorCode) = this(cause.getMessage, cause, errorCode)</span>

  override def printStackTrace(s: PrintStream) {
<span class="nc" id="L44">    s.synchronized {</span>
<span class="nc" id="L45">      printStackTrace(new PrintWriter(s))</span>
    }
  }

  override def printStackTrace(s: PrintWriter) {
<span class="nc" id="L50">    s.synchronized {</span>
<span class="nc" id="L51">      s.println(this)</span>
<span class="nc" id="L52">      getStackTrace.foreach { trace =&gt;</span>
<span class="nc" id="L53">        s.println(&quot;\tat &quot; + trace)</span>
      }
<span class="nc bnc" id="L55" title="All 2 branches missed.">      if (cause != null) {</span>
<span class="nc" id="L56">        cause.printStackTrace(s)</span>
      }
<span class="nc" id="L58">      s.flush()</span>
    }
  }

  override def toString = {
<span class="nc" id="L63">    val sb = new StringBuilder</span>
<span class="nc bnc" id="L64" title="All 2 branches missed.">    if (errorCode != null) {</span>
<span class="nc" id="L65">      sb.append(&quot;monad-&quot;).append(errorCode.code).append(&quot;:&quot;)</span>
<span class="nc" id="L66">      sb.append(errorCode.getClass.getSimpleName).append(&quot; &quot;)</span>
    } else {
<span class="nc" id="L68">      sb.append(&quot;monad-0000 UNKNOWN &quot;)</span>
    }
<span class="nc bnc" id="L70" title="All 2 branches missed.">    if (message != null) {</span>
<span class="nc" id="L71">      sb.append(message)</span>
    }
<span class="nc bnc" id="L73" title="All 2 branches missed.">    if (cause != null) {</span>
<span class="nc" id="L74">      sb.append(&quot; -&gt; &quot;).append(cause)</span>
    }

<span class="nc" id="L77">    sb.toString()</span>
  }

}

<span class="nc" id="L82">abstract class ErrorCode(val code: Int)</span>

<span class="nc" id="L84">object UNKNOWN extends ErrorCode(2)</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>